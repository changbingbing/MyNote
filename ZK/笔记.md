# 分布式协调服务器Zookeeper

ZK提供一致性服务，主要功能：配置维护、域名服务、分布式同步、集群管理。

### 主要功能

* 配置维护
  通过发布、订阅模式来实现配置维护
  ![image-20190123214416122](https://ws2.sinaimg.cn/large/006tNc79ly1fzguq4t4m5j30f90840tm.jpg)

* 域名服务

  将域名和集群机器信息注册到zk中

  ![image-20190123215031165](https://ws3.sinaimg.cn/large/006tNc79ly1fzguwkexrcj30fz0bvdip.jpg)

* 分布式同步

  * 即：服务执行有序，一个service执行完，下一个service执行。
  * Znode可以存储所监听的主机（各主机在Znode上注册一个watcher值为0，执行完则0变成1，然后触发下一个service之行）
  * Znode和主机之间通过ping、pong心跳来感知主机状态。
  * 感知主机异常，会尝试修复，修复不了，则会记录日志到消息中间件。
    ![image-20190123215754204](https://ws1.sinaimg.cn/large/006tNc79ly1fzgv48hauoj30e608gt9z.jpg)

* 集群管理



### 一致性要求

* 顺序一致性

* 原子性：无论集群哪个机器执行请求结果都是一致的。

* 单一视图：无论连接集群哪个机器，看到的数据都是一样的

* 可靠性：一旦执行成功，结果是不会改变的

* 实时性

### ZK重要概念

* Session：客户端会话，通过**TCP长连接**建立链接的。
* znode：其实它就是个目录，通过**树形结构**存储数据，每个znode和版本号也有关
* watcher机制
* ACL：访问控制列表，即设置权限（传统文件系统FS具有两个维度，ZK中的FS具有三个维度）
* 

## znode存储

## watcher机制

## ZK操作Api

## Paxos算法（不好理解部分）

### 三种角色

* 提议者、表决着、学习者
* 同一个进程同时充当着三种角色
* prepare(N)有可能小于Max(N)，但绝不会等于！因为异步而非同步，且N的生成机制（递增）
* 活锁：执行者本身没有被阻塞
* 死锁：争夺资源。必需具备的条件：
  * 互斥（一个资源只能被一个进程使用）
  * 请求与保持



## ZAB协议

![](/Users/changbingbing/Library/Application Support/typora-user-images/image-20190213150313364.png)

![](/Users/changbingbing/Library/Application Support/typora-user-images/image-20190213145608400.png)

## Leader选举算法

## ZK源码解析（主要就是Leader选举算法）

## ZK集群搭建（参考文档自己搭建）



* 中间方法（返回类型都是Builder）、最终方法（返回最终类型）
* 雪峰老师的流编程视频
* UUID：36个字符（占字符多，没有语意）





# 分布式RPC框架Dubbo

默认端口号：20880

## ZK注册中心

## 服务治理与监控平台

## 多版本控制

## 服务分组

## 多协议支持

## 负载均衡

## 集群容错 

## 服务降级

## 服务限流

## Dubbo源码分析

# 反向代理服务器Nginx

## Nginx性能调优

## 日志管理及自动切割

## 静态代理

## 反向代理

## 负载均衡

## 动静分离

## 虚拟主机

# 快速开发框架SpringBoot

## 手写Starter

## Tymeleaf

# 响应式web开发框架WebFlux

主要应对高并发、异步（目前公司用的不多，但是开发前景）

## Reactive Stream编程

## WebFlux的传统处理器开发

## WebFlux的Router Functions开发

# 分布式消息系统Kafka

底层其实即使ZK

## Kafka工作原理

## Kafka集群搭建（参考文档自己搭建）

## Kafka Api

# 微服务框架Spring Cloud

## 微服务注册中心Eureka

## 声明式REST客户端OpenFeign

## Hystrix熔断机制与服务降级

## 微服务网关Zuul

## Spring Cloud Config分布式配置中心

## Spring Cloud Stream消息微服务

## Spring Cloud Sleuth分布式监控链路

## Spring cloud Bus事件、消息总线

## 