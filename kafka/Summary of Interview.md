* kafka如何做到消息不丢失

  1. ACK机制
     通过 ACK 机制保证消息送达。Kafka 采用的是至少一次（At least once），消息不会丢，但是可能会重复传输。
  2. 发送消息
     * 为了得到更好的性能，Kafka 支持在生产者一侧进行本地buffer，也就是累积到一定的条数才发送，如果这里设置不当是会丢消息的。
     * 生产者端设置 producer.type=async, sync，默认是 sync。
     * 当设置为 async，会大幅提升性能，因为生产者会在本地缓冲消息，并适时批量发送。
     * 如果对可靠性要求高，那么这里可以设置为 sync 同步发送。
  3. 消费消息
     如果更注重可靠性，则需要显示提交 Offset，也就是当所有业务都处理完成的时候，再提交 Offset。这样会导致重复消费，需要提供幂等性接口。

* 为什么kafka这么快？

  * 顺序写磁盘
    顺序写磁盘的性能是随机写入的性能的6000倍的提升，媲美内存随机访问的性能，磁盘不再是瓶颈点。

  * Page Cache
    为了优化读写性能，Kafka利用了操作系统本身的Page Cache，就是利用操作系统自身的内存而不是JVM空间内存。通过操作系统的Page Cache，Kafka的读写操作基本上是基于内存的，读写速度得到了极大的提升。

  * 零拷贝

    零拷贝技术，可以有效的减少上下文切换和拷贝次数。

    其实，kafka的设计实现，涉及到太多的底层技术，为了能够把它吃透，需要花大量的时间和精力。

* kafka 可以脱离 zookeeper 单独使用吗？为什么？

  * Zookeeper 负责维护和协调 broker。当然,zk 还负责 Broker Controller 的选举。

* kafka 有几种数据保留的策略？

* kafka 同时设置了 7 天和 10G 清除数据，到第五天的时候消息达到了 10G，这个时候 kafka 将如何处理？

* 什么情况会导致 kafka 运行变慢？

* 使用 kafka 集群需要注意什么？

